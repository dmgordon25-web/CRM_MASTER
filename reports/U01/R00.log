npm warn Unknown env config "http-proxy". This will stop working in the next major version of npm.

> crmtool@0.1.0 test:unit
> vitest run --config vitest.config.mjs


 RUN  v0.34.6 /workspace/CRM_MASTER

 ❯ tests/unit/uiStringsUsage.spec.ts  (3 tests | 2 failed) 798ms
   ❯ tests/unit/uiStringsUsage.spec.ts > UI modules consume STR > quick_add pulls modal copy from STR
     → expected "spy" to be called at least once
   ❯ tests/unit/uiStringsUsage.spec.ts > UI modules consume STR > calendar implementation uses STR entries
     → render is not a function
 ❯ tests/unit/renderGuard.spec.ts  (4 tests | 3 failed) 842ms
   ❯ tests/unit/renderGuard.spec.ts > App render coordination > refreshes partners without triggering a global render
     → button.removeAttribute is not a function
   ❯ tests/unit/renderGuard.spec.ts > App render coordination > coalesces partial partners change events
     → button.removeAttribute is not a function
   ❯ tests/unit/renderGuard.spec.ts > App render coordination > falls back to global render when scope not handled
     → button.removeAttribute is not a function
 ❯ tests/unit/contacts_merge.spec.ts  (2 tests | 2 failed) 98ms
   ❯ tests/unit/contacts_merge.spec.ts > contact merge UI > resolves conflicting fields and preserves extras from both contacts
     → expected undefined to be truthy
   ❯ tests/unit/contacts_merge.spec.ts > contact merge UI > merges records, rewires linked items, and dispatches once
     → Cannot read properties of undefined (reading 'createState')
 ❯ tests/unit/convertLongShotToPipeline.spec.ts  (1 test | 1 failed) 57ms
   ❯ tests/unit/convertLongShotToPipeline.spec.ts > convertLongShotToPipeline > promotes a Long Shot contact into the pipeline with a single dispatch
     → expected 'undefined' to be 'function' // Object.is equality
 ❯ tests/unit/pipelineStages.spec.ts  (3 tests | 3 failed) 37ms
   ❯ tests/unit/pipelineStages.spec.ts > pipelineStages normalizeStage > normalizes common aliases
     → expected 'Long Shot' to be 'CTC' // Object.is equality
   ❯ tests/unit/pipelineStages.spec.ts > pipelineStages normalizeStage > warns only once for unknown values and defaults to Processing
     → expected 'Long Shot' to be 'Processing' // Object.is equality
   ❯ tests/unit/pipelineStages.spec.ts > pipelineStages normalizeStage > exposes canonical key helpers
     → expected 'long-shot' to be 'cleared-to-close' // Object.is equality
 ❯ tests/unit/toast.spec.ts  (1 test | 1 failed) 39ms
   ❯ tests/unit/toast.spec.ts > Toast host > coalesces duplicate show calls within 500ms
     → document.createElementNS is not a function
 ❯ tests/unit/dashboardFocus.test.js  (3 tests | 3 failed) 20ms
   ❯ tests/unit/dashboardFocus.test.js > Dashboard focus layout > renders Today view with focus widgets and hides secondary sections by default
     → Unexpected token 'export'
   ❯ tests/unit/dashboardFocus.test.js > Dashboard focus layout > switches to All mode and shows configured widgets
     → Unexpected token 'export'
   ❯ tests/unit/dashboardFocus.test.js > Dashboard focus layout > persists widget visibility toggles across reloads
     → Unexpected token 'export'
 ❯ tests/unit/formFooter.spec.ts  (2 tests | 2 failed) 21ms
   ❯ tests/unit/formFooter.spec.ts > FormFooter > renders cancel then save buttons and emits events once
     → Failed to load url ../../crm-app/js/ui/FormFooter.tsx (resolved id: ../../crm-app/js/ui/FormFooter.tsx). Does the file exist?
   ❯ tests/unit/formFooter.spec.ts > FormFooter > maps Enter and Escape to save and cancel actions
     → Failed to load url ../../crm-app/js/ui/FormFooter.tsx (resolved id: ../../crm-app/js/ui/FormFooter.tsx). Does the file exist?
 ❯ tests/unit/accessibilityTokens.test.js  (3 tests | 1 failed) 10ms
   ❯ tests/unit/accessibilityTokens.test.js > accessibility tokens > defines a base font size of at least 16px
     → body font size token should exist: expected null to be truthy
 ❯ tests/unit/settings.test.js  (5 tests | 5 failed) 21ms
   ❯ tests/unit/settings.test.js > Settings data access > merges partial saves, persists to IndexedDB, and dispatches once per save
     → Unexpected token 'export'
   ❯ tests/unit/settings.test.js > Settings data access > normalizes dashboard preferences and merges widget visibility
     → Unexpected token 'export'
   ❯ tests/unit/settings.test.js > Settings data access > invokes the toast API after a successful save
     → Unexpected token 'export'
   ❯ tests/unit/settings.test.js > Settings data access > falls back to dispatchEvent when no dispatcher is registered
     → Unexpected token 'export'
   ❯ tests/unit/settings.test.js > Settings data access > round-trips goals, signature, and profile with one dispatch per save
     → Unexpected token 'export'
stdout | tests/unit/updateContactStage.spec.ts > updateContactStage > persists stage transitions and emits exactly one app:data:changed
[patch_2025-09-26_phase1_pipeline_partners.init] complete

stdout | tests/unit/updateContactStage.spec.ts > updateContactStage > restores previous stage metadata when reverting
[patch_2025-09-26_phase1_pipeline_partners.init] complete

 ✓ tests/unit/updateContactStage.spec.ts  (2 tests) 169ms
 ✓ tests/unit/calendar_dnd.spec.ts  (4 tests) 291ms
 ✓ tests/unit/calendar_impl.spec.ts  (2 tests) 257ms
 ✓ tests/unit/dashboardLayoutPersistence.test.js  (2 tests) 167ms
 ✓ tests/unit/softDelete.spec.ts  (3 tests) 53ms
 ✓ tests/unit/quickAdd.spec.ts  (2 tests) 34ms
 ✓ tests/unit/importer.test.js  (8 tests) 51ms
 ✓ tests/unit/notifications.spec.ts  (2 tests) 60ms
 ✓ tests/unit/importer_dedupe.spec.ts  (2 tests) 50ms
 ✓ tests/unit/commissions_listener.spec.ts  (2 tests) 26ms
 ✓ tests/unit/merge_partners.spec.ts  (2 tests) 22ms
 ✓ tests/unit/importer_trunc.spec.ts  (2 tests) 58ms
 ✓ tests/unit/ical.spec.ts  (1 test) 27ms
 ✓ tests/unit/selectionStore.spec.ts  (3 tests) 28ms
 ✓ tests/unit/actionBarGuards.spec.ts  (4 tests) 8ms
 ✓ tests/unit/seedDemoData.spec.ts  (2 tests) 14ms
 ✓ tests/unit/strings.spec.ts  (2 tests) 4ms
 ✓ tests/unit/bootstrap.test.js  (1 test) 4ms

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯ Failed Tests 23 ⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯

 FAIL  tests/unit/accessibilityTokens.test.js > accessibility tokens > defines a base font size of at least 16px
AssertionError: body font size token should exist: expected null to be truthy

- Expected: 
null

+ Received: 
false

 ❯ tests/unit/accessibilityTokens.test.js:15:56
     13|   it('defines a base font size of at least 16px', () => {
     14|     const match = tokensSource.match(/--body-font-size:\s*([0-9.]+)px/…
     15|     expect(match, 'body font size token should exist').toBeTruthy();
       |                                                        ^
     16|     expect(Number(match[1])).toBeGreaterThanOrEqual(16);
     17|   });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/23]⎯

 FAIL  tests/unit/contacts_merge.spec.ts > contact merge UI > resolves conflicting fields and preserves extras from both contacts
AssertionError: expected undefined to be truthy

- Expected: 
undefined

+ Received: 
false

 ❯ tests/unit/contacts_merge.spec.ts:75:19
     73|     await import(MODULE_PATH);
     74|     const hooks = (window as any).__CONTACT_MERGE_TEST__;
     75|     expect(hooks).toBeTruthy();
       |                   ^
     76| 
     77|     const contactA: ContactRecord = {

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/23]⎯

 FAIL  tests/unit/contacts_merge.spec.ts > contact merge UI > merges records, rewires linked items, and dispatches once
TypeError: Cannot read properties of undefined (reading 'createState')
 ❯ tests/unit/contacts_merge.spec.ts:183:25
    181|     const dialogStub = { close: vi.fn(), removeAttribute: vi.fn(), sty…
    182| 
    183|     const state = hooks.createState([
       |                         ^
    184|       clone(contactsStore.get('keep')),
    185|       clone(contactsStore.get('drop'))

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/23]⎯

 FAIL  tests/unit/convertLongShotToPipeline.spec.ts > convertLongShotToPipeline > promotes a Long Shot contact into the pipeline with a single dispatch
AssertionError: expected 'undefined' to be 'function' // Object.is equality

- Expected
+ Received

- function
+ undefined

 ❯ tests/unit/convertLongShotToPipeline.spec.ts:146:28
    144| 
    145|     const convert = (windowStub as any).convertLongShotToPipeline;
    146|     expect(typeof convert).toBe('function');
       |                            ^
    147| 
    148|     const result = await convert('c1');

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/23]⎯

 FAIL  tests/unit/dashboardFocus.test.js > Dashboard focus layout > renders Today view with focus widgets and hides secondary sections by default
 FAIL  tests/unit/dashboardFocus.test.js > Dashboard focus layout > switches to All mode and shows configured widgets
 FAIL  tests/unit/dashboardFocus.test.js > Dashboard focus layout > persists widget visibility toggles across reloads
SyntaxError: Unexpected token 'export'
 ❯ new Script node:vm:117:7
 ❯ createScript node:vm:269:10
 ❯ Object.runInThisContext node:vm:317:10
 ❯ runScript tests/unit/dashboardFocus.test.js:14:6
     12| function runScript(relativePath) {
     13|   const code = readFileSync(join(jsRoot, relativePath), 'utf8');
     14|   vm.runInThisContext(code, { filename: relativePath });
       |      ^
     15| }
     16| 
 ❯ resetEnvironment tests/unit/dashboardFocus.test.js:320:3
 ❯ tests/unit/dashboardFocus.test.js:385:5

Module db.js:482 seems to be an ES Module but shipped in a CommonJS package. You might want to create an issue to the package "db.js:482" asking them to ship the file in .mjs extension or add "type": "module" in their package.json.

As a temporary workaround you can try to inline the package by updating your config:

// vitest.config.js
export default {
  test: {
    server: {
      deps: {
        inline: [
          "db.js:482"
        ]
      }
    }
  }
}

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/23]⎯

 FAIL  tests/unit/formFooter.spec.ts > FormFooter > renders cancel then save buttons and emits events once
 FAIL  tests/unit/formFooter.spec.ts > FormFooter > maps Enter and Escape to save and cancel actions
Error: Failed to load url ../../crm-app/js/ui/FormFooter.tsx (resolved id: ../../crm-app/js/ui/FormFooter.tsx). Does the file exist?
 ❯ loadAndTransform node_modules/vite/dist/node/chunks/dep-D_zLpgQd.js:51968:17

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/23]⎯

 FAIL  tests/unit/pipelineStages.spec.ts > pipelineStages normalizeStage > normalizes common aliases
AssertionError: expected 'Long Shot' to be 'CTC' // Object.is equality

- Expected
+ Received

- CTC
+ Long Shot

 ❯ tests/unit/pipelineStages.spec.ts:30:75
     28|     expect((globalThis as any).window.normalizeStage('Pre App')).toBe(…
     29|     expect((globalThis as any).window.normalizeStage('c.t.c.')).toBe('…
     30|     expect((globalThis as any).window.normalizeStage('Cleared to Close…
       |                                                                           ^
     31|     expect((globalThis as any).window.normalizeStage('funding')).toBe(…
     32|     expect(warnSpy).not.toHaveBeenCalled();

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/23]⎯

 FAIL  tests/unit/pipelineStages.spec.ts > pipelineStages normalizeStage > warns only once for unknown values and defaults to Processing
AssertionError: expected 'Long Shot' to be 'Processing' // Object.is equality

- Expected
+ Received

- Processing
+ Long Shot

 ❯ tests/unit/pipelineStages.spec.ts:39:45
     37|     const { warnSpy } = await loadModule();
     38|     const normalizeStage = (globalThis as any).window.normalizeStage;
     39|     expect(normalizeStage('unknown-stage')).toBe('Processing');
       |                                             ^
     40|     expect(normalizeStage('another mystery')).toBe('Processing');
     41|     expect(warnSpy).toHaveBeenCalledTimes(1);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/23]⎯

 FAIL  tests/unit/pipelineStages.spec.ts > pipelineStages normalizeStage > exposes canonical key helpers
AssertionError: expected 'long-shot' to be 'cleared-to-close' // Object.is equality

- Expected
+ Received

- cleared-to-close
+ long-shot

 ❯ tests/unit/pipelineStages.spec.ts:50:51
     48|     const stageLabelFromKey = (globalThis as any).window.stageLabelFro…
     49|     expect(stageKeyFromLabel('Pre-Approved')).toBe('preapproved');
     50|     expect(stageKeyFromLabel('cleared-to-close')).toBe('cleared-to-clo…
       |                                                   ^
     51|     expect(stageKeyFromLabel('Lead')).toBe('lead');
     52|     expect(stageLabelFromKey('cleared-to-close')).toBe('CTC');

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/23]⎯

 FAIL  tests/unit/renderGuard.spec.ts > App render coordination > refreshes partners without triggering a global render
 FAIL  tests/unit/renderGuard.spec.ts > App render coordination > coalesces partial partners change events
 FAIL  tests/unit/renderGuard.spec.ts > App render coordination > falls back to global render when scope not handled
TypeError: button.removeAttribute is not a function
 ❯ ensureLayoutResetButton crm-app/js/dashboard/index.js:440:14
    438|       delete button.dataset.loading;
    439|     } else {
    440|       button.removeAttribute('data-loading');
       |              ^
    441|     }
    442|   }
 ❯ ensureLayoutToggle crm-app/js/dashboard/index.js:565:3
 ❯ init crm-app/js/dashboard/index.js:2910:7
 ❯ crm-app/js/dashboard/index.js:2938:1
 ❯ crm-app/js/app.js:1:31

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/23]⎯

 FAIL  tests/unit/settings.test.js > Settings data access > merges partial saves, persists to IndexedDB, and dispatches once per save
 FAIL  tests/unit/settings.test.js > Settings data access > normalizes dashboard preferences and merges widget visibility
 FAIL  tests/unit/settings.test.js > Settings data access > invokes the toast API after a successful save
 FAIL  tests/unit/settings.test.js > Settings data access > falls back to dispatchEvent when no dispatcher is registered
 FAIL  tests/unit/settings.test.js > Settings data access > round-trips goals, signature, and profile with one dispatch per save
SyntaxError: Unexpected token 'export'
 ❯ new Script node:vm:117:7
 ❯ createScript node:vm:269:10
 ❯ Object.runInThisContext node:vm:317:10
 ❯ runScript tests/unit/settings.test.js:14:6
     12| function runScript(relativePath) {
     13|   const code = readFileSync(join(jsRoot, relativePath), 'utf8');
     14|   vm.runInThisContext(code, { filename: relativePath });
       |      ^
     15| }
     16| 
 ❯ resetEnvironment tests/unit/settings.test.js:90:3
 ❯ tests/unit/settings.test.js:98:3

Module db.js:482 seems to be an ES Module but shipped in a CommonJS package. You might want to create an issue to the package "db.js:482" asking them to ship the file in .mjs extension or add "type": "module" in their package.json.

As a temporary workaround you can try to inline the package by updating your config:

// vitest.config.js
export default {
  test: {
    server: {
      deps: {
        inline: [
          "db.js:482"
        ]
      }
    }
  }
}

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/23]⎯

 FAIL  tests/unit/toast.spec.ts > Toast host > coalesces duplicate show calls within 500ms
TypeError: document.createElementNS is not a function
 ❯ createIconSvg crm-app/js/ui/Toast.js:56:26
     54| 
     55|   function createIconSvg(key, path){
     56|     const svg = document.createElementNS(SVG_NS, 'svg');
       |                          ^
     57|     svg.setAttribute('viewBox', '0 0 24 24');
     58|     svg.setAttribute('aria-hidden', 'true');
 ❯ getToastIcon crm-app/js/ui/Toast.js:81:31
 ❯ ToastController.show crm-app/js/ui/Toast.js:159:22
 ❯ tests/unit/toast.spec.ts:59:11

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/23]⎯

 FAIL  tests/unit/uiStringsUsage.spec.ts > UI modules consume STR > quick_add pulls modal copy from STR
AssertionError: expected "spy" to be called at least once
 ❯ tests/unit/uiStringsUsage.spec.ts:107:39
    105|     doc.querySelector = vi.fn((selector: string) => selector === '[dat…
    106|     await import('../../crm-app/js/quick_add.js');
    107|     expect(quickBtn.addEventListener).toHaveBeenCalled();
       |                                       ^
    108|     const handler = quickBtn.addEventListener.mock.calls[0][1];
    109|     handler({ preventDefault: vi.fn() });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/23]⎯

 FAIL  tests/unit/uiStringsUsage.spec.ts > UI modules consume STR > calendar implementation uses STR entries
TypeError: render is not a function
 ❯ tests/unit/uiStringsUsage.spec.ts:143:11
    141|     await import('../../crm-app/js/calendar_impl.js');
    142|     const render = windowStub.__CALENDAR_IMPL__.render as Function;
    143|     await render(new Date(), 'month');
       |           ^
    144|     expect(used).toContain('calendar.legend.event-types');
    145|     expect(used).toContain('calendar.event.follow-up');

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[14/23]⎯

 Test Files  10 failed | 18 passed (28)
      Tests  23 failed | 50 passed (73)
   Start at  02:34:41
   Duration  9.76s (transform 709ms, setup 63ms, collect 999ms, tests 3.27s, environment 5ms, prepare 3.42s)

